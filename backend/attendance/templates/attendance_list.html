{% extends "base.html" %}
{% load static %}

{% block title %}Attendance Overview{% endblock %}
{% block header_title %}Attendance Overview{% endblock %}

{% block content %}
  <!-- â”€â”€â”€ new roll shortcut â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <p style="margin-bottom:1.2rem;">
    <a href="{% url 'attendance:attendance_select' %}"
       class="btn-primary">
       + New roll
    </a>
  </p>

  <!-- â”€â”€â”€ filter bar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <form method="get" class="attendance-overview-filter"
        style="display:flex; gap:.8rem; flex-wrap:wrap; margin-bottom:1.5rem;">
    <label for="class">Class:</label>
    <select name="class" id="class">
      <option value="">All classes</option>
      {% for cls in class_choices %}
        <option value="{{ cls.id }}"
                {% if filter_class == cls.id|stringformat:"s" %}selected{% endif %}>
          {{ cls.name }}
        </option>
      {% endfor %}
    </select>

    <label for="date">Date:</label>
    <input type="text" name="date" id="date" value="{{ filter_date }}">

    <button type="submit" class="btn-primary">Filter</button>
  </form>

  <!-- â”€â”€â”€ results table â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <table class="attendance-table" style="width:100%; border-collapse:collapse;">
    <thead>
      <tr>
        <th>Date</th>
        <th>Student</th>
        <th>Class</th>
        <th>Status</th>
        <th style="text-align:right;">Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for rec in records %}
        <tr>
          <td>{{ rec.date|date:"M j, Y" }}</td>
          <td>{{ rec.student.full_name }}</td>
          <td>{{ rec.student.school_class.name }}</td>
          <td>{{ rec.get_status_display }}</td>
          <td style="text-align:right;">
            <a href="{% url 'attendance:attendance_edit' rec.pk %}">âœŽ</a>
            <a href="{% url 'attendance:attendance_delete' rec.pk %}">ðŸ—‘</a>
          </td>
        </tr>
      {% empty %}
        <tr>
          <td colspan="5">No attendance records found.</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- â”€â”€â”€ Flatpickr (date field) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      flatpickr("#date", {
        altFormat: "F j, Y",
        allowInput: true
      });
    });
  </script>
{% endblock %}
